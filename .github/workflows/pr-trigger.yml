name: pr-trigger

on:
  pull_request:
    types:
      - labeled


jobs:
  #  check-if-we-can-run:
  #    runs-on: ubuntu-latest
  #    if: ${{github.event.action == 'labeled' && github.event.label.name == 'ci'}}
  #    steps:
  #      - name: Run on label
  #        run: |
  #          echo "Completed"
  workflow-dispatch:
    runs-on: ubuntu-latest
    steps:
      - uses: LouisBrunner/checks-action@v1.6.2
        id: check
        with:
          sha: ${{ github.sha }}
          token: ${{ secrets.BOT_GITHUB_TOKEN }}
          name: Second Job
          status: in_progress

      - name: Trigger test-workflow
        id: trigger-test-workflow
        uses: aurelien-baudet/workflow-dispatch@v2.1.1
        with:
          repo: RahulKumar1606/test-repo
          ref: ${{ github.event.pull_request.head.ref }}
          workflow: test-workflow.yml
          token: ${{ secrets.BOT_GITHUB_TOKEN }}
          wait-for-completion: true
          display-workflow-run-url: true

      - uses: LouisBrunner/checks-action@v1.6.2
        if: failure()
        with:
          sha: ${{ github.sha }}
          token: ${{ secrets.BOT_GITHUB_TOKEN }}
          name: Second Job
          conclusion: ${{ job.status }}
          output: |
            {"summary":""}
